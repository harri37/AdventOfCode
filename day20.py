data = """#############################################################################################################################################
###...#.......#.....#...#...#...#.......#.......#.......###...#...###...#...#...#...#.......#...###...#...#...#.....#...#.............#...###
###.#.#.#####.#.###.#.#.#.#.#.#.#.#####.#.#####.#.#####.###.#.#.#.###.#.#.#.#.#.#.#.#.#####.#.#.###.#.#.#.#.#.#.###.#.#.#.###########.#.#.###
#...#.#.....#.#...#...#...#...#.#...#...#.....#.#.#.....#...#...#.#...#...#...#.#.#.#.....#.#.#.....#.#.#.#.#.#.#...#.#...#...#.....#...#...#
#.###.#####.#.###.#############.###.#.#######.#.#.#.#####.#######.#.###########.#.#.#####.#.#.#######.#.#.#.#.#.#.###.#####.#.#.###.#######.#
#...#.###...#.#...#...#...#...#...#.#.#...###.#.#.#.....#...#.....#...#.....#...#.#.....#.#...#.......#.#.#.#.#.#...#...#...#...###.........#
###.#.###.###.#.###.#.#.#.#.#.###.#.#.#.#.###.#.#.#####.###.#.#######.#.###.#.###.#####.#.#####.#######.#.#.#.#.###.###.#.###################
#...#...#...#.#.....#...#...#...#...#...#.#...#.#.#...#.#...#...#...#...###.#...#...#...#.#.....#...#...#.#.#...#...#...#...................#
#.#####.###.#.#################.#########.#.###.#.#.#.#.#.#####.#.#.#######.###.###.#.###.#.#####.#.#.###.#.#####.###.#####################.#
#.....#.#...#...#.........#...#.....#.....#...#.#.#.#...#...#...#.#...###...#...#...#...#.#.#...#.#.#...#...#...#.#...#.....#...#...........#
#####.#.#.#####.#.#######.#.#.#####.#.#######.#.#.#.#######.#.###.###.###.###.###.#####.#.#.#.#.#.#.###.#####.#.#.#.###.###.#.#.#.###########
#...#.#.#.#.....#.......#.#.#.......#...#...#.#...#...#...#.#...#...#...#...#...#...#...#.#.#.#...#...#.#.....#...#...#.###...#...#.........#
#.#.#.#.#.#.###########.#.#.###########.#.#.#.#######.#.#.#.###.###.###.###.###.###.#.###.#.#.#######.#.#.###########.#.###########.#######.#
#.#.#.#...#.#...#.....#.#.#.......#.....#.#.#...#.....#.#...#...###...#.....#...#...#...#.#.#.#.......#.#.#...#...#...#.......#...#.#.....#.#
#.#.#.#####.#.#.#.###.#.#.#######.#.#####.#.###.#.#####.#####.#######.#######.###.#####.#.#.#.#.#######.#.#.#.#.#.#.#########.#.#.#.#.###.#.#
#.#.#.....#.#.#.#...#.#.#.#.....#.#.###...#.....#.#.....#.....#...###.......#...#...#...#.#.#.#.#.....#.#.#.#.#.#.#.#.......#.#.#...#.###...#
#.#.#####.#.#.#.###.#.#.#.#.###.#.#.###.#########.#.#####.#####.#.#########.###.###.#.###.#.#.#.#.###.#.#.#.#.#.#.#.#.#####.#.#.#####.#######
#.#.......#...#.....#...#.#...#.#.#...#.........#.#.#.....###...#...#...#...#...#...#.....#...#...#...#.#.#.#...#...#.....#...#.#.....#.....#
#.#######################.###.#.#.###.#########.#.#.#.#######.#####.#.#.#.###.###.#################.###.#.#.#############.#####.#.#####.###.#
#.#...#...#...#.........#...#.#.#...#.#...#.....#...#...#...#.#.....#.#.#...#.###.......#...........#...#.#...#...........###...#.....#.#...#
#.#.#.#.#.#.#.#.#######.###.#.#.###.#.#.#.#.###########.#.#.#.#.#####.#.###.#.#########.#.###########.###.###.#.#############.#######.#.#.###
#...#...#...#...#.......#...#.#...#.#.#.#.#.....#.......#.#.#.#.#...#.#.#...#...#.......#.....#...###...#.###.#.#...#.......#...#.....#.#...#
#################.#######.###.###.#.#.#.#.#####.#.#######.#.#.#.#.#.#.#.#.#####.#.###########.#.#.#####.#.###.#.#.#.#.#####.###.#.#####.###.#
#.....#...#...###.......#...#...#.#.#.#.#.#...#.#.#.....#.#...#...#.#.#.#...#...#...#.........#.#.....#.#.#...#...#.#.#.....#...#.#...#.#...#
#.###.#.#.#.#.#########.###.###.#.#.#.#.#.#.#.#.#.#.###.#.#########.#.#.###.#.#####.#.#########.#####.#.#.#.#######.#.#.#####.###.#.#.#.#.###
#...#...#.#.#.#...#...#.#...#...#.#.#.#.#.#.#...#.#.#...#...#.....#.#.#.#...#.#...#.#...#...###.#.....#.#.#...#.....#.#.#...#.#...#.#.#.#...#
###.#####.#.#.#.#.#.#.#.#.###.###.#.#.#.#.#.#####.#.#.#####.#.###.#.#.#.#.###.#.#.#.###.#.#.###.#.#####.#.###.#.#####.#.#.#.#.#.###.#.#.###.#
###.#...#...#...#...#...#.###...#.#.#.#.#.#...#...#.#.#.....#...#...#.#.#...#.#.#...#...#.#...#.#...#...#.#...#.#...#.#.#.#...#.#...#...#...#
###.#.#.#################.#####.#.#.#.#.#.###.#.###.#.#.#######.#####.#.###.#.#.#####.###.###.#.###.#.###.#.###.#.#.#.#.#.#####.#.#######.###
#...#.#.............#...#.....#.#.#.#.#.#.###.#.###.#.#...#.....#...#.#.#...#.#...#...###.#...#.#...#.#...#.#...#.#...#.#.#.....#.#.......###
#.###.#############.#.#.#####.#.#.#.#.#.#.###.#.###.#.###.#.#####.#.#.#.#.###.###.#.#####.#.###.#.###.#.###.#.###.#####.#.#.#####.#.#########
#...#.#...........#...#.....#.#.#.#.#.#.#...#.#...#.#...#.#...#...#.#.#...#...###.#.#...#.#...#.#...#.#...#.#.###.#.....#.#.#...#.#.#.......#
###.#.#.#########.#########.#.#.#.#.#.#.###.#.###.#.###.#.###.#.###.#.#####.#####.#.#.#.#.###.#.###.#.###.#.#.###.#.#####.#.#.#.#.#.#.#####.#
###...#.........#.###.......#...#...#.#...#.#.#...#...#.#.#...#.#...#.....#.#...#.#.#.#.#...#.#.#...#.#...#.#.#...#...###.#.#.#.#.#.#.#.....#
###############.#.###.###############.###.#.#.#.#####.#.#.#.###.#.#######.#.#.#.#.#.#.#.###.#.#.#.###.#.###.#.#.#####.###.#.#.#.#.#.#.#.#####
#...#...#.......#.....#.............#.....#.#.#.#...#.#.#.#...#.#.....#...#...#.#.#...#.....#.#.#...#.#...#.#...#...#.....#...#...#...#.#...#
#.#.#.#.#.#############.###########.#######.#.#.#.#.#.#.#.###.#.#####.#.#######.#.###########.#.###.#.###.#.#####.#.###################.#.#.#
#.#...#...#...#...#.....###...#...#.#.....#.#.#.#.#.#.#.#.###.#.....#...#.......#...........#...#...#.#...#.#.....#.........#.........#...#.#
#.#########.#.#.#.#.#######.#.#.#.#.#.###.#.#.#.#.#.#.#.#.###.#####.#####.#################.#####.###.#.###.#.#############.#.#######.#####.#
#.....#...#.#.#.#.#.#.......#...#...#.#...#...#.#.#.#.#.#.#...#...#...###.#.....#.....#...#...###.....#.....#...#.......#...#.......#.#...#.#
#####.#.#.#.#.#.#.#.#.###############.#.#######.#.#.#.#.#.#.###.#.###.###.#.###.#.###.#.#.###.#################.#.#####.#.#########.#.#.#.#.#
#...#...#.#.#...#...#.................#.#...###.#.#.#.#...#...#.#.#...#...#.#...#...#.#.#.#...#...#...........#...#...#.#.#.......#.#...#...#
#.#.#####.#.###########################.#.#.###.#.#.#.#######.#.#.#.###.###.#.#####.#.#.#.#.###.#.#.#########.#####.#.#.#.#.#####.#.#########
#.#.#.....#.#.........................#...#...#.#.#.#.###.....#.#.#.###...#.#.#...#.#...#...#...#...#.......#.......#...#...#.....#...#...###
#.#.#.#####.#.#######################.#######.#.#.#.#.###.#####.#.#.#####.#.#.#.#.#.#########.#######.#####.#################.#######.#.#.###
#.#...#.....#.......................#.#.....#.#.#.#.#.#...#...#.#.#...###...#.#.#.#...#...###.#.......###...###...#...#...###...#...#...#...#
#.#####.###########################.#.#.###.#.#.#.#.#.#.###.#.#.#.###.#######.#.#.###.#.#.###.#.#########.#####.#.#.#.#.#.#####.#.#.#######.#
#.#.....#.....#...........#...#.....#.#...#.#.#.#.#...#.....#.#.#...#...#.....#.#...#...#...#...#...#...#.......#...#...#.....#.#.#...#...#.#
#.#.#####.###.#.#########.#.#.#.#####.###.#.#.#.#.###########.#.###.###.#.#####.###.#######.#####.#.#.#.#####################.#.#.###.#.#.#.#
#...###...#...#.........#...#.#.....#.....#...#.#...###.......#.###.#...#...#...#...#.....#.#.....#...#.................#.....#...#...#.#.#.#
#######.###.###########.#####.#####.###########.###.###.#######.###.#.#####.#.###.###.###.#.#.#########################.#.#########.###.#.#.#
###...#...#.#...#...###.....#.....#.........###...#...#.#.....#.#...#...###.#.###...#...#...#...............#.........#...#.......#.#...#...#
###.#.###.#.#.#.#.#.#######.#####.#########.#####.###.#.#.###.#.#.#####.###.#.#####.###.###################.#.#######.#####.#####.#.#.#######
#...#.....#...#.#.#.#...#...#...#...........#...#.#...#...###...#.#...#...#.#.....#...#.....#.....#.........#.#.....#.#.....#.....#...###...#
#.#############.#.#.#.#.#.###.#.#############.#.#.#.#############.#.#.###.#.#####.###.#####.#.###.#.#########.#.###.#.#.#####.###########.#.#
#.............#...#...#.#.....#...........#...#.#...###..E#.......#.#...#.#...#...###...#...#...#.#...........#...#...#.....#.#...#.....#.#.#
#############.#########.#################.#.###.#######.###.#######.###.#.###.#.#######.#.#####.#.###############.#########.#.#.#.#.###.#.#.#
#...........#.........#...................#.#...#.......###.....#...#...#.###.#.#.....#...#...#.#.......#.......#...###...#.#...#...#...#.#.#
#.#########.#########.#####################.#.###.#############.#.###.###.###.#.#.###.#####.#.#.#######.#.#####.###.###.#.#.#########.###.#.#
#.........#...........#.................###.#.###.###########...#...#...#...#.#.#...#.......#...#.....#...#...#...#...#.#.#.#...#.....###.#.#
#########.#############.###############.###.#.###.###########.#####.###.###.#.#.###.#############.###.#####.#.###.###.#.#.#.#.#.#.#######.#.#
#.........#.....#.......#.........#...#.....#.....###########...#...#...#...#...#...#...#.....#...###.#.....#...#.....#.#.#.#.#...###.....#.#
#.#########.###.#.#######.#######.#.#.#########################.#.###.###.#######.###.#.#.###.#.#####.#.#######.#######.#.#.#.#######.#####.#
#.........#...#.#...#.....#.....#...#S#########################...###...#.....###.....#...###...#...#...#.......###.....#...#.......#.#.....#
#########.###.#.###.#.#####.###.#######################################.#####.###################.#.#####.#########.###############.#.#.#####
#.........#...#.....#.....#.###.............###########################...#...#...#...###.........#.....#...........#.........#.....#.#.#...#
#.#########.#############.#.###############.#############################.#.###.#.#.#.###.#############.#############.#######.#.#####.#.#.#.#
#...#...#...###...#...###...#...............#############################.#...#.#.#.#...#.............#.....#.......#.......#.#...#...#...#.#
###.#.#.#.#####.#.#.#.#######.###########################################.###.#.#.#.###.#############.#####.#.#####.#######.#.###.#.#######.#
###...#...#.....#...#.........#...........###############################.....#.#...#...###...#.....#.....#...#...#.....#...#.....#.#.....#.#
###########.###################.#########.#####################################.#####.#####.#.#.###.#####.#####.#.#####.#.#########.#.###.#.#
#.........#.#...................#.........#...###.......#######################.#...#.#...#.#.#...#.#...#.......#.....#...#####...#.#...#.#.#
#.#######.#.#.###################.#########.#.###.#####.#######################.#.#.#.#.#.#.#.###.#.#.#.#############.#########.#.#.###.#.#.#
#.......#.#...#...#...#...#...###...........#.....#...#.....#################...#.#.#...#...#.....#...#.....#...#...#.#.....#...#...#...#...#
#######.#.#####.#.#.#.#.#.#.#.#####################.#.#####.#################.###.#.#######################.#.#.#.#.#.#.###.#.#######.#######
#.....#.#...#...#...#...#...#...........#...#...#...#.#.....#.......###...###.....#.....#...#...#.........#...#...#...#...#.#...#.....#...###
#.###.#.###.#.#########################.#.#.#.#.#.###.#.#####.#####.###.#.#############.#.#.#.#.#.#######.###############.#.###.#.#####.#.###
#...#.#...#.#.........#.....#...#...###...#...#...###...#...#.#.....#...#.#.............#.#...#...###...#...........###...#.....#.......#...#
###.#.###.#.#########.#.###.#.#.#.#.#####################.#.#.#.#####.###.#.#############.###########.#.###########.###.###################.#
#...#.....#...........#.###.#.#...#...............#...#...#...#...#...#...#...............#...........#.............#...#...#.........#...#.#
#.#####################.###.#.###################.#.#.#.#########.#.###.###################.#########################.###.#.#.#######.#.#.#.#
#.#.....#...........#...#...#.#.......#...........#.#.#...#.......#...#.#.....#.....#...###...#.....#...............#...#.#.#.......#.#.#.#.#
#.#.###.#.#########.#.###.###.#.#####.#.###########.#.###.#.#########.#.#.###.#.###.#.#.#####.#.###.#.#############.###.#.#.#######.#.#.#.#.#
#...###.#.#.........#...#...#.#.#...#...#.......#...#.#...#...#...#...#.#.#...#...#...#.......#.###.#.#.....#.......###.#.#.........#.#.#.#.#
#######.#.#.###########.###.#.#.#.#.#####.#####.#.###.#.#####.#.#.#.###.#.#.#####.#############.###.#.#.###.#.#########.#.###########.#.#.#.#
#.....#.#.#.........#...###...#...#.......#.....#.#...#.....#...#.#...#.#.#.#...#.........#...#.#...#.#...#...#...#.....#...#.......#...#...#
#.###.#.#.#########.#.#####################.#####.#.#######.#####.###.#.#.#.#.#.#########.#.#.#.#.###.###.#####.#.#.#######.#.#####.#########
#.#...#...#.........#.#.....#.............#.#.....#...#...#.#.....#...#.#.#.#.#...#.....#...#.#.#.....###.......#...#.....#...#...#.........#
#.#.#######.#########.#.###.#.###########.#.#.#######.#.#.#.#.#####.###.#.#.#.###.#.###.#####.#.#####################.###.#####.#.#########.#
#.#...#...#.........#.#.#...#...........#.#...#.......#.#...#.#...#...#.#.#...#...#...#...###...#.............#...#...###.#...#.#...........#
#.###.#.#.#########.#.#.#.#############.#.#####.#######.#####.#.#.###.#.#.#####.#####.###.#######.###########.#.#.#.#####.#.#.#.#############
#...#...#.###...###...#.#.............#.#...#...#.....#.....#...#...#.#.#.#.....#...#...#.#.....#...........#...#.#.....#.#.#...###...#...###
###.#####.###.#.#######.#############.#.###.#.###.###.#####.#######.#.#.#.#.#####.#.###.#.#.###.###########.#####.#####.#.#.#######.#.#.#.###
###.....#.....#.........#...........#.#.###...###...#.#...#.#.....#...#...#.......#.#...#.#.#...#.......#...#...#.....#.#...#.......#...#...#
#######.#################.#########.#.#.###########.#.#.#.#.#.###.#################.#.###.#.#.###.#####.#.###.#.#####.#.#####.#############.#
#.......#...#.....#.......#.........#.#.#.......#...#.#.#.#...###.....#.........#...#...#...#.....#...#.#.....#.....#...#...#.#...........#.#
#.#######.#.#.###.#.#######.#########.#.#.#####.#.###.#.#.###########.#.#######.#.#####.###########.#.#.###########.#####.#.#.#.#########.#.#
#.......#.#.#.###...#.....#.........#...#.#.....#...#.#.#.###.....#...#.....###...#...#.............#.#.....#.....#...#...#...#.....#...#...#
#######.#.#.#.#######.###.#########.#####.#.#######.#.#.#.###.###.#.#######.#######.#.###############.#####.#.###.###.#.###########.#.#.#####
#...###...#...#...###...#.#...#.....###...#.....###.#.#.#.#...#...#...#.....#...###.#.###.....#.....#.....#.#...#...#...#...#.....#...#.....#
#.#.###########.#.#####.#.#.#.#.#######.#######.###.#.#.#.#.###.#####.#.#####.#.###.#.###.###.#.###.#####.#.###.###.#####.#.#.###.#########.#
#.#.............#.#...#.#.#.#.#.......#.#.......#...#...#.#.#...#...#.#.....#.#...#.#.#...#...#...#...#...#.....###.......#...###.#...#...#.#
#.###############.#.#.#.#.#.#.#######.#.#.#######.#######.#.#.###.#.#.#####.#.###.#.#.#.###.#####.###.#.#########################.#.#.#.#.#.#
#.#...#.....#...#...#...#...#.........#.#.###...#.......#.#.#.###.#.#.#.....#.#...#.#.#...#.#...#.#...#...........#.........#.....#.#...#.#.#
#.#.#.#.###.#.#.#######################.#.###.#.#######.#.#.#.###.#.#.#.#####.#.###.#.###.#.#.#.#.#.#############.#.#######.#.#####.#####.#.#
#.#.#...###...#...#.............#.....#.#...#.#.#...#...#.#.#...#.#.#.#.....#.#.#...#...#.#.#.#.#.#.....#...#...#...#...#...#.....#.....#.#.#
#.#.#############.#.###########.#.###.#.###.#.#.#.#.#.###.#.###.#.#.#.#####.#.#.#.#####.#.#.#.#.#.#####.#.#.#.#.#####.#.#.#######.#####.#.#.#
#.#.#.............#.#...#.......#...#.#.#...#.#.#.#.#.#...#.#...#.#.#.#.....#.#.#...#...#.#.#.#.#...###.#.#...#.#...#.#...#.....#.#...#.#.#.#
#.#.#.#############.#.#.#.#########.#.#.#.###.#.#.#.#.#.###.#.###.#.#.#.#####.#.###.#.###.#.#.#.###.###.#.#####.#.#.#.#####.###.#.#.#.#.#.#.#
#...#...............#.#.#.......#...#...#.....#.#.#...#.#...#...#.#.#.#...#...#.#...#.....#.#.#.#...#...#...###...#.#.......#...#.#.#.#.#.#.#
#####################.#.#######.#.#############.#.#####.#.#####.#.#.#.###.#.###.#.#########.#.#.#.###.#####.#######.#########.###.#.#.#.#.#.#
#.................#...#.........#.#.............#...#...#.#...#.#.#...#...#...#.#.#...#.....#.#.#...#.#...#.......#...........###...#.#.#.#.#
#.###############.#.#############.#.###############.#.###.#.#.#.#.#####.#####.#.#.#.#.#.#####.#.###.#.#.#.#######.###################.#.#.#.#
#.........#.....#...#...#.....#...#...#...#.....#...#...#...#.#.#.....#...#...#.#...#.#...#...#...#.#.#.#...#...#...................#...#...#
#########.#.###.#####.#.#.###.#.#####.#.#.#.###.#.#####.#####.#.#####.###.#.###.#####.###.#.#####.#.#.#.###.#.#.###################.#########
#...#...#...###.....#.#...#...#.....#.#.#.#.#...#.#####...#...#.#...#.#...#.###.#.....###.#.#.....#.#...###.#.#.#...#.....#.........###...###
#.#.#.#.###########.#.#####.#######.#.#.#.#.#.###.#######.#.###.#.#.#.#.###.###.#.#######.#.#.#####.#######.#.#.#.#.#.###.#.###########.#.###
#.#...#.............#.#...#.....#...#.#.#.#.#...#...#.....#.#...#.#.#.#...#.#...#.....#...#.#.#...#...###...#.#.#.#...###.#.......#.....#...#
#.###################.#.#.#####.#.###.#.#.#.###.###.#.#####.#.###.#.#.###.#.#.#######.#.###.#.#.#.###.###.###.#.#.#######.#######.#.#######.#
#...........#...#...#...#...#...#...#.#.#...#...#...#.#...#.#.#...#.#.###...#.#.......#.#...#...#...#...#...#.#.#.......#.#...#...#.#.......#
###########.#.#.#.#.#######.#.#####.#.#.#####.###.###.#.#.#.#.#.###.#.#######.#.#######.#.#########.###.###.#.#.#######.#.#.#.#.###.#.#######
#...........#.#...#.#...#...#...#...#.#...#...#...#...#.#.#.#.#...#.#.#.......#.....#...#.........#...#...#.#.#.#...#...#...#.#.....#.....###
#.###########.#####.#.#.#.#####.#.###.###.#.###.###.###.#.#.#.###.#.#.#.###########.#.###########.###.###.#.#.#.#.#.#.#######.###########.###
#.#.....#...#.#.....#.#.#.#...#.#...#...#.#...#.###.....#.#.#.....#...#.....#...#...#.#...#.......###...#.#.#.#...#.#.......#...#...#...#...#
#.#.###.#.#.#.#.#####.#.#.#.#.#.###.###.#.###.#.#########.#.###############.#.#.#.###.#.#.#.###########.#.#.#.#####.#######.###.#.#.#.#.###.#
#...###...#...#.#...#.#.#.#.#...#...###...#...#...###...#.#...#...###.......#.#...###...#...#...###...#.#.#.#.....#.........###.#.#.#.#...#.#
###############.#.#.#.#.#.#.#####.#########.#####.###.#.#.###.#.#.###.#######.###############.#.###.#.#.#.#.#####.#############.#.#.#.###.#.#
#.....#.........#.#.#.#...#.....#.....###...#...#.....#.#.#...#.#.....#.....#.................#...#.#...#.#.#.....#...........#.#.#...###...#
#.###.#.#########.#.#.#########.#####.###.###.#.#######.#.#.###.#######.###.#####################.#.#####.#.#.#####.#########.#.#.###########
#...#.#.........#.#.#.....#.....#...#.#...#...#...#.....#.#...#.#.....#.#...#.....#...#...#.......#.....#.#.#.#.....#.....#...#.#...........#
###.#.#########.#.#.#####.#.#####.#.#.#.###.#####.#.#####.###.#.#.###.#.#.###.###.#.#.#.#.#.###########.#.#.#.#.#####.###.#.###.###########.#
#...#.........#.#.#...#...#.....#.#...#.#...#.....#.....#.....#...#...#.#...#...#.#.#.#.#.#.....#.......#.#.#...#.....###...#...#...#...#...#
#.###########.#.#.###.#.#######.#.#####.#.###.#########.###########.###.###.###.#.#.#.#.#.#####.#.#######.#.#####.###########.###.#.#.#.#.###
#.#.....#...#...#.#...#.#.......#...#...#...#...#.....#...#.....#...#...###...#.#...#.#.#...#...#.....#...#.....#...........#.#...#...#...###
#.#.###.#.#.#####.#.###.#.#########.#.#####.###.#.###.###.#.###.#.###.#######.#.#####.#.###.#.#######.#.#######.###########.#.#.#############
#.#.#...#.#...#...#.#...#.......#...#.#.....###...#...#...#...#...#...#...#...#...#...#.###.#.......#.#.......#.#...........#.#...........###
#.#.#.###.###.#.###.#.#########.#.###.#.###########.###.#####.#####.###.#.#.#####.#.###.###.#######.#.#######.#.#.###########.###########.###
#.#.#...#...#.#...#.#.....#.....#.#...#...#.........#...#.....#...#.....#.#...#...#...#.#...#...#...#.#...#...#.#...........#...#...#...#...#
#.#.###.###.#.###.#.#####.#.#####.#.#####.#.#########.###.#####.#.#######.###.#.#####.#.#.###.#.#.###.#.#.#.###.###########.###.#.#.#.#.###.#
#...###.....#.....#.......#.......#.......#...........###.......#.........###...#####...#.....#...###...#...###.............###...#...#.....#
#############################################################################################################################################"""


from collections import deque

map = [list(line) for line in data.split("\n")]

def in_bounds(i, j):
    return 0 <= i < len(map) and 0 <= j < len(map[0])

def get_neighbours(i, j):
    return [(i + di, j + dj) for di, dj in [(1,0), (0,1), (-1,0), (0,-1)] if in_bounds(i+di, j+dj) and map[i+di][j+dj] != "#"]

start_pos = (-1, -1)

for i in range(len(map)):
    for j in range(len(map[0])):
        if map[i][j] == "S":
            start_pos = (i, j)

class Node:
    def __init__(self, i, j, prev):
        self.i = i
        self.j = j
        self.prev = prev
    
    def get_pos(self):
        return self.i, self.j

start_node = Node(start_pos[0], start_pos[1], None)
queue = deque()
seen = set()
seen.add(start_pos)
queue.append(start_node)

while queue:
    curr = queue.popleft()
    ci, cj = curr.get_pos()
    if map[ci][cj] == "E":
        break
    neighs = get_neighbours(ci, cj)
    for neigh in neighs:
        if neigh not in seen:
            seen.add(neigh)
            queue.append(Node(neigh[0], neigh[1], curr))
            
dists = {}
to_end = 0
path = []
while curr:
    dists[curr.get_pos()] = to_end
    path.append(curr.get_pos())
    curr = curr.prev
    to_end += 1

points = set(path)
path = list(reversed(path))
    
def get_cheats(i, j):
    return [(i + di, j + dj) 
            for di, dj in [(2,0), (1,1), (-2,0), (0,-2), (1,-1), (-1,1), (-1,-1), (0,2)] 
            if (i+di, j+dj) in points 
            and dists[(i,j)] - dists[(i+di, j+dj)] - 2 >= 100]
    
print(sum([len(get_cheats(i, j)) for i, j in path]))

# PART 2
count = 0
for s_index in range(len(path)):
    si, sj = path[s_index]
    for e_index in range(len(path)):
        ei, ej = path[e_index]
        cheat_len = abs(si-ei) + abs(sj-ej)
        if cheat_len <= 20 \
            and dists[(si,sj)] - dists[(ei, ej)] - cheat_len >= 100:
                count += 1
print(count)